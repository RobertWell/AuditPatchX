-- Test schema initialization for Oracle DB
-- This script creates test tables and populates them with sample data

-- Create TESTUSER schema tables
CREATE TABLE TESTUSER.DEPARTMENT (
    DEPT_ID NUMBER(10) PRIMARY KEY,
    DEPT_NAME VARCHAR2(100) NOT NULL,
    LOCATION VARCHAR2(100),
    BUDGET NUMBER(15,2)
);

CREATE TABLE TESTUSER.EMPLOYEE (
    EMP_ID NUMBER(10) PRIMARY KEY,
    FIRST_NAME VARCHAR2(50) NOT NULL,
    LAST_NAME VARCHAR2(50) NOT NULL,
    EMAIL VARCHAR2(100),
    PHONE VARCHAR2(20),
    HIRE_DATE DATE NOT NULL,
    SALARY NUMBER(10,2),
    BIO CLOB,
    DEPT_ID NUMBER(10),
    MANAGER_ID NUMBER(10),
    CONSTRAINT fk_emp_dept FOREIGN KEY (DEPT_ID) REFERENCES TESTUSER.DEPARTMENT(DEPT_ID)
);

CREATE TABLE TESTUSER.JOB_HISTORY (
    EMPLOYEE_ID NUMBER(10),
    START_DATE DATE,
    END_DATE DATE,
    JOB_TITLE VARCHAR2(100) NOT NULL,
    DEPARTMENT_ID NUMBER(10),
    CONSTRAINT pk_job_history PRIMARY KEY (EMPLOYEE_ID, START_DATE),
    CONSTRAINT fk_jobhist_emp FOREIGN KEY (EMPLOYEE_ID) REFERENCES TESTUSER.EMPLOYEE(EMP_ID),
    CONSTRAINT fk_jobhist_dept FOREIGN KEY (DEPARTMENT_ID) REFERENCES TESTUSER.DEPARTMENT(DEPT_ID)
);

-- Insert test data for DEPARTMENT
INSERT INTO TESTUSER.DEPARTMENT (DEPT_ID, DEPT_NAME, LOCATION, BUDGET)
VALUES (1, 'Engineering', 'San Francisco', 1000000.00);

INSERT INTO TESTUSER.DEPARTMENT (DEPT_ID, DEPT_NAME, LOCATION, BUDGET)
VALUES (2, 'Sales', 'New York', 750000.00);

INSERT INTO TESTUSER.DEPARTMENT (DEPT_ID, DEPT_NAME, LOCATION, BUDGET)
VALUES (3, 'HR', 'Chicago', 500000.00);

-- Insert test data for EMPLOYEE
INSERT INTO TESTUSER.EMPLOYEE (EMP_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE, HIRE_DATE, SALARY, DEPT_ID, MANAGER_ID)
VALUES (1, 'John', 'Doe', 'john.doe@example.com', '555-0101', TO_DATE('2020-01-15', 'YYYY-MM-DD'), 85000.00, 1, NULL);

INSERT INTO TESTUSER.EMPLOYEE (EMP_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE, HIRE_DATE, SALARY, DEPT_ID, MANAGER_ID)
VALUES (2, 'Jane', 'Smith', 'jane.smith@example.com', '555-0102', TO_DATE('2020-03-20', 'YYYY-MM-DD'), 75000.00, 1, 1);

INSERT INTO TESTUSER.EMPLOYEE (EMP_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE, HIRE_DATE, SALARY, DEPT_ID, MANAGER_ID)
VALUES (3, 'Bob', 'Johnson', 'bob.johnson@example.com', '555-0103', TO_DATE('2021-06-10', 'YYYY-MM-DD'), 65000.00, 2, 1);

INSERT INTO TESTUSER.EMPLOYEE (EMP_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE, HIRE_DATE, SALARY, DEPT_ID, MANAGER_ID)
VALUES (4, 'Alice', 'Williams', 'alice.williams@example.com', '555-0104', TO_DATE('2021-09-01', 'YYYY-MM-DD'), 70000.00, 3, 1);

INSERT INTO TESTUSER.EMPLOYEE (EMP_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE, HIRE_DATE, SALARY, DEPT_ID, MANAGER_ID)
VALUES (5, 'Charlie', 'Brown', 'charlie.brown@example.com', '555-0105', TO_DATE('2022-01-15', 'YYYY-MM-DD'), 60000.00, 2, 3);

-- Insert test data for JOB_HISTORY
INSERT INTO TESTUSER.JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_TITLE, DEPARTMENT_ID)
VALUES (2, TO_DATE('2020-03-20', 'YYYY-MM-DD'), TO_DATE('2021-03-20', 'YYYY-MM-DD'), 'Junior Developer', 1);

INSERT INTO TESTUSER.JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_TITLE, DEPARTMENT_ID)
VALUES (2, TO_DATE('2021-03-21', 'YYYY-MM-DD'), NULL, 'Senior Developer', 1);

INSERT INTO TESTUSER.JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_TITLE, DEPARTMENT_ID)
VALUES (3, TO_DATE('2021-06-10', 'YYYY-MM-DD'), NULL, 'Sales Representative', 2);

COMMIT;
